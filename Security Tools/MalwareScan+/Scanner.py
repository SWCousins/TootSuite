import os
import hashlib


def scan(setlist):
    
    for pathname, dirnames, filenames in os.walk('../..'):
            if filenames != []:
                for file in filenames:   
                    filename = os.path.join(pathname, file)
                    # Validate the file exists
                    if os.path.isfile(filename):
                        # Initalize and update a sha1 hasher
                        hasher = hashlib.sha1()
                        hasher.update(open(filename, 'rb').read())
                        # Create a hexidecimal hash digest
                        filehash = hasher.hexdigest()
                        #
                        if filehash.upper() in setlist:
                            print('\033[91m Malware detected! \033[0m' + filename)
                            print(filehash)
                        else:
                            print('\033[92m Malware not found... \033[0m' + filename)
                            print(filehash)
            else:
                print("Done")
